/*!
 * Start Bootstrap - SB Admin 2 v4.1.3 (https://startbootstrap.com/theme/sb-admin-2)
 * Copyright 2013-2020 Start Bootstrap
 * Licensed under MIT (https://github.com/StartBootstrap/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */

function getTime(e){var o,t,a=document.getElementById(e).value.split(":");return 12<(o=a[0])?(t="PM",o-=12):o<12?(t="AM",0==o&&(o=12)):t="PM",o+":"+a[1]+" "+t}!function(s){"use strict";s("#sidebarToggle, #sidebarToggleTop").on("click",function(e){s("body").toggleClass("sidebar-toggled"),s(".sidebar").toggleClass("toggled"),s(".sidebar").hasClass("toggled")&&s(".sidebar .collapse").collapse("hide")}),s(window).resize(function(){s(window).width()<768&&s(".sidebar .collapse").collapse("hide"),s(window).width()<480&&!s(".sidebar").hasClass("toggled")&&(s("body").addClass("sidebar-toggled"),s(".sidebar").addClass("toggled"),s(".sidebar .collapse").collapse("hide"))}),s("body.fixed-nav .sidebar").on("mousewheel DOMMouseScroll wheel",function(e){if(768<s(window).width()){var o=e.originalEvent,t=o.wheelDelta||-o.detail;this.scrollTop+=30*(t<0?1:-1),e.preventDefault()}}),s(document).on("scroll",function(){100<s(this).scrollTop()?s(".scroll-to-top").fadeIn():s(".scroll-to-top").fadeOut()}),s(document).on("click","a.scroll-to-top",function(e){var o=s(this);s("html, body").stop().animate({scrollTop:s(o.attr("href")).offset().top},1e3,"easeInOutExpo"),e.preventDefault()}),s("#closeBloodSugarReading").click(function(){s("form#addReading").trigger("reset"),s("#successMessage").toggleClass("d-none")}),s("#closeMeal").click(function(){s("form#addMeal").trigger("reset"),s("#successMealMessage").toggleClass("d-none")}),s("form#loginForm").submit(function(){var e=s("#username").val(),o=s("#password").val();return s.ajax({type:"POST",url:"http://localhost:8080/login",data:JSON.stringify({username:e,password:o}),contentType:"application/json",success:function(e,o,t){console.log(e),localStorage.setItem("user",e.patientId),window.location="index.html?user="+e.patientId},error:function(e,o,t){console.log("error"),s("#errorMessage").removeClass("d-none")}}),!1}),s("form#addReading").submit(function(){var e=s("#reading").val(),o=getTime("time"),t=localStorage.getItem("user"),a=null===s("#description1").val()?s("#description2").val():s("#description1").val();return s.ajax({type:"POST",url:"http://localhost:8080/observation",data:JSON.stringify({patientId:t,description:a,reading:e,time:o}),contentType:"application/json",success:function(e,o,t){console.log(e),s("#successMessage").toggleClass("d-none")},error:function(e,o,t){console.log("error")}}),!1}),s("form#addMeal").submit(function(){var e=s("#mealName").val(),o=getTime("mealTime"),t=localStorage.getItem("user"),a=s("#mealPortion").val(),l=s("#foodInfo").val();return s.ajax({type:"POST",url:"http://localhost:8080/nutritionOrder",data:JSON.stringify({patientId:t,name:e,dosage:a,unit:l,time:o}),contentType:"application/json",success:function(e,o,t){console.log(e),s("#successMealMessage").toggleClass("d-none")},error:function(e,o,t){console.log("error")}}),!1}),s("#searchFoodButton").click(function(){var e=s("#mealName").val(),o=(document.getElementById("results"),null);s.ajax({type:"GET",url:"http://localhost:8080/food/find?foodName="+e,success:function(e){o=e.branded,s("#searchFood").modal("toggle");var t='<table class="table">';t+="<th>No</th>",t+="<th>Food name</th>",t+="<th>Calories</th>",t+="<th>Serving quantity</th>",t+="<th>Select</th>",s(o).each(function(e,o){t+="<tr>",t+="<td>"+e+"</td>",t+="<td>"+o.food_name+"</td>",t+="<td>"+o.nf_calories+"</td>",t+="<td>"+o.serving_qty+"</td>",t+="<td><button id='selectFoodButton'  type='button' class='btn btn-primary'>Select</button></td>",t+="</tr>"}),t+="</table>",s("#searchFoodTable").html(t)},error:function(e,o,t){console.log("Error: "+e.responseText)}})}),s("#searchFood #searchFoodTable").on("click","#selectFoodButton",function(){var e=s(this).closest("tr").find("td"),o="";s.each(e,function(){console.log(s(this).text()),o+=s(this).text()+":"}),s("#searchFood").modal("hide"),s("#foodInfo").val(o),s("#mealName").val(o.split(":")[1])}),s("#closeSearch").click(function(){s("#searchFood").modal("hide")})}(jQuery);