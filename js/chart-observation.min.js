/*!
 * Start Bootstrap - SB Admin 2 v4.1.3 (https://startbootstrap.com/theme/sb-admin-2)
 * Copyright 2013-2020 Start Bootstrap
 * Licensed under MIT (https://github.com/StartBootstrap/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */

function number_format(t,e,a,r){t=(t+"").replace(",","").replace(" ","");var o=isFinite(+t)?+t:0,t=isFinite(+e)?Math.abs(e):0,e=void 0===r?",":r,r=void 0===a?".":a,a="";return 3<(a=(t?function(t,e){e=Math.pow(10,e);return""+Math.round(t*e)/e}(o,t):""+Math.round(o)).split("."))[0].length&&(a[0]=a[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,e)),(a[1]||"").length<t&&(a[1]=a[1]||"",a[1]+=new Array(t-a[1].length+1).join("0")),a.join(r)}function formatDate(t){var e=t.getDate(),a=t.getMonth()+1;return e<10&&(e="0"+e),a<10&&(a="0"+a),t=a+"/"+e+"/"+t.getFullYear()}function formateDatev2(t){return(8<(t=new Date(t)).getMonth()?t.getMonth()+1:"0"+(t.getMonth()+1))+"/"+(9<t.getDate()?t.getDate():"0"+t.getDate())+"/"+t.getFullYear()}function Last7Days(){for(var t=[],e=7;0<e;e--){var a=new Date;a.setDate(a.getDate()-e),t.push(formatDate(a))}return t}function groupBy(t,r){return t.reduce(function(t,e){var a=e[r];return t[a]||(t[a]=[]),t[a].push(e),t},{})}function updateData(t){for(var e=0;e<t.length;e++){var a=t[e].time.split(":")[0];t[e].time=a}return t}function updateData2(t,e){for(var a=0;a<t.length;a++){var r=new Date(e),o=new Date(formateDatev2(t[a].time));console.log(r+":"+o),o<r&&t.splice(a,1)}return t}function getData(){var t=localStorage.getItem("user"),l=[];return $.ajax({type:"GET",url:"https://diabetes-tracker-backend.herokuapp.com/observation/"+t,async:!1,success:function(t){var e,a=groupBy(updateData2(updateData(t),Last7Days()[0]),"time"),r=0;for(e in a){var o=Math.max.apply(Math,a[e].map(function(t){return t.diabeticRecord}));l[r]=o,r++}if(l.length<=7)for(var n=7-l.length,i=0;i<n;i++)l.unshift(0)},error:function(t,e,a){console.log("Error: "+t.responseText)}}),console.log(l),l}Chart.defaults.global.defaultFontFamily="Nunito",Chart.defaults.global.defaultFontColor="#858796";var ctx=document.getElementById("myAreaChart2"),result=Last7Days(),myLineChart=new Chart(ctx,{type:"line",data:{labels:result,datasets:[{label:"Diabetic record",lineTension:.3,backgroundColor:"rgba(78, 115, 223, 0.05)",borderColor:"rgba(78, 115, 223, 1)",pointRadius:3,pointBackgroundColor:"rgba(78, 115, 223, 1)",pointBorderColor:"rgba(78, 115, 223, 1)",pointHoverRadius:3,pointHoverBackgroundColor:"rgba(78, 115, 223, 1)",pointHoverBorderColor:"rgba(78, 115, 223, 1)",pointHitRadius:10,pointBorderWidth:2,data:getData()}]},options:{maintainAspectRatio:!1,layout:{padding:{left:10,right:25,top:25,bottom:0}},scales:{xAxes:[{time:{unit:"date"},gridLines:{display:!1,drawBorder:!1},ticks:{maxTicksLimit:7}}],yAxes:[{ticks:{maxTicksLimit:5,padding:10,callback:function(t,e,a){return number_format(t)+" mg/dL"}},gridLines:{color:"rgb(234, 236, 244)",zeroLineColor:"rgb(234, 236, 244)",drawBorder:!1,borderDash:[2],zeroLineBorderDash:[2]}}]},legend:{display:!1},tooltips:{backgroundColor:"rgb(255,255,255)",bodyFontColor:"#858796",titleMarginBottom:10,titleFontColor:"#6e707e",titleFontSize:14,borderColor:"#dddfeb",borderWidth:1,xPadding:15,yPadding:15,displayColors:!1,intersect:!1,mode:"index",caretPadding:10,callbacks:{label:function(t,e){return(e.datasets[t.datasetIndex].label||"")+": "+number_format(t.yLabel)+" mg/dL"}}}}});